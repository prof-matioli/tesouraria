<Window x:Class="Tesouraria.Desktop.Views.Cadastros.LancamentoListaView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:converters="clr-namespace:Tesouraria.Desktop.Converters"
        mc:Ignorable="d"
        Title="Gestão Financeira - Tesouraria" Height="600" Width="1000"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <converters:TipoTransacaoToColorConverter x:Key="TipoColorConverter"/>
    </Window.Resources>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Border Grid.Row="0" BorderBrush="LightGray" BorderThickness="1" Padding="10" Margin="0,0,0,10" CornerRadius="5">
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <TextBlock Text="De:" VerticalAlignment="Center" Margin="0,0,5,0" FontWeight="Bold"/>
                <DatePicker SelectedDate="{Binding DataInicio}" Width="120" Margin="0,0,15,0"/>

                <TextBlock Text="Até:" VerticalAlignment="Center" Margin="0,0,5,0" FontWeight="Bold"/>
                <DatePicker SelectedDate="{Binding DataFim}" Width="120" Margin="0,0,20,0"/>

                <Button Content="🔍 Filtrar" Command="{Binding BuscarCommand}" Width="100" Height="25"/>
            </StackPanel>
        </Border>

        <DataGrid Grid.Row="1" 
                  ItemsSource="{Binding Lancamentos}" 
                  SelectedItem="{Binding LancamentoSelecionado}"
                  AutoGenerateColumns="False" 
                  CanUserAddRows="False"
                  IsReadOnly="True"
                  SelectionMode="Single"
                  GridLinesVisibility="Horizontal">

            <DataGrid.Columns>
                <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="80"/>

                <DataGridTextColumn Header="Vencimento" Binding="{Binding DataVencimento, StringFormat=dd/MM/yyyy}" Width="90"/>

                <DataGridTextColumn Header="Descrição" Binding="{Binding Descricao}" Width="*"/>

                <DataGridTextColumn Header="Fiel/Fornecedor" Binding="{Binding PessoaNome}" Width="150"/>

                <DataGridTextColumn Header="Categoria" Binding="{Binding CategoriaNome}" Width="130"/>

                <DataGridTemplateColumn Header="Tipo" Width="80">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Tipo}" 
                                       Foreground="{Binding Tipo, Converter={StaticResource TipoColorConverter}}"
                                       FontWeight="Bold"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>

                <DataGridTextColumn Header="Valor" Binding="{Binding ValorOriginal, StringFormat=C2}" Width="100" FontWeight="Bold"/>

                <DataGridTextColumn Header="Baixa" Binding="{Binding DataPagamento, StringFormat=dd/MM/yyyy}" Width="90"/>
            </DataGrid.Columns>
        </DataGrid>

        <Grid Grid.Row="2" Margin="0,15,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <TextBlock Text="Saldo do Período (Realizado): " FontSize="16"/>
                <TextBlock Text="{Binding SaldoPeriodo, StringFormat=C2}" FontSize="16" FontWeight="Bold" Foreground="Blue"/>
            </StackPanel>

            <StackPanel Grid.Column="1" Orientation="Horizontal">
                <Button Content="❌ Cancelar Lançamento" 
                        Command="{Binding CancelarCommand}" 
                        Background="#FFECECEC" Foreground="Red"
                        Width="150" Height="35" Margin="0,0,10,0"/>

                <Button Content="💲 BAIXAR / PAGAR" 
                        Command="{Binding BaixarCommand}" 
                        Width="150" Height="35" Margin="0,0,10,0" FontWeight="Bold"/>

                <Button Content="➕ NOVO LANÇAMENTO" 
                        Command="{Binding NovoCommand}" 
                        Width="160" Height="35" FontWeight="Bold" Background="#FFDDFFDD"/>
            </StackPanel>
        </Grid>
    </Grid>
</Window>