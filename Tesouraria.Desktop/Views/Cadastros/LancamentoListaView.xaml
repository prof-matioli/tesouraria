<Window x:Class="Tesouraria.Desktop.Views.Cadastros.LancamentoListaView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:converters="clr-namespace:Tesouraria.Desktop.Converters"
        mc:Ignorable="d"
        Title="Gestão Financeira - Tesouraria" Height="650" Width="1000"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <converters:TipoTransacaoToColorConverter x:Key="TipoColorConverter"/>
    </Window.Resources>

    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Border Grid.Row="0" BorderBrush="#DDDDDD" BorderThickness="1" Padding="10" Margin="0,0,0,10" CornerRadius="5" Background="#FAFAFA">
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <TextBlock Text="De:" VerticalAlignment="Center" Margin="0,0,5,0" FontWeight="SemiBold"/>
                <DatePicker SelectedDate="{Binding DataInicio}" Width="120" Margin="0,0,15,0" VerticalContentAlignment="Center"/>

                <TextBlock Text="Até:" VerticalAlignment="Center" Margin="0,0,5,0" FontWeight="SemiBold"/>
                <DatePicker SelectedDate="{Binding DataFim}" Width="120" Margin="0,0,20,0" VerticalContentAlignment="Center"/>

                <Button Content="🔍 Filtrar" Command="{Binding BuscarCommand}" Width="100" Height="30"/>

                <CheckBox Content="Exibir Cancelados" 
                  IsChecked="{Binding ExibirCancelados}" 
                  VerticalAlignment="Center" 
                  Margin="20,0,0,0"
                  FontSize="14"/>
            </StackPanel>
        </Border>

        <DataGrid Grid.Row="1" 
                  ItemsSource="{Binding Lancamentos}" 
                  SelectedItem="{Binding LancamentoSelecionado}"
                  AutoGenerateColumns="False" 
                  CanUserAddRows="False"
                  IsReadOnly="True"
                  SelectionMode="Single"
                  GridLinesVisibility="Horizontal"
                  BorderThickness="1"
                  BorderBrush="#DDDDDD">

            <DataGrid.RowStyle>
                <Style TargetType="DataGridRow">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding Cancelado}" Value="True">
                            <Setter Property="Foreground" Value="Red"/>
                            <Setter Property="FontStyle" Value="Italic"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </DataGrid.RowStyle>
            
            <DataGrid.Resources>
                <Style TargetType="DataGridColumnHeader">
                    <Setter Property="Padding" Value="10,5"/>
                    <Setter Property="FontWeight" Value="SemiBold"/>
                    <Setter Property="Background" Value="#F0F0F0"/>
                </Style>
                <Style TargetType="DataGridCell">
                    <Setter Property="Padding" Value="5"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="DataGridCell">
                                <Border Padding="{TemplateBinding Padding}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" SnapsToDevicePixels="True">
                                    <ContentPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                                </Border>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </DataGrid.Resources>

            <DataGrid.Columns>
                <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="90"/>

                <DataGridTextColumn Header="Vencimento" Binding="{Binding DataVencimento, StringFormat=dd/MM/yyyy}" Width="100"/>

                <DataGridTextColumn Header="Descrição" Binding="{Binding Descricao}" Width="*"/>

                <DataGridTextColumn Header="Fiel/Fornecedor" Binding="{Binding PessoaNome}" Width="180"/>

                <DataGridTextColumn Header="Categoria" Binding="{Binding CategoriaNome}" Width="150"/>

                <DataGridTemplateColumn Header="Tipo" Width="90">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Tipo}" 
                                       Foreground="{Binding Tipo, Converter={StaticResource TipoColorConverter}}"
                                       FontWeight="Bold"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>

                <DataGridTextColumn Header="Valor Original" Binding="{Binding ValorOriginal, StringFormat=C2}" Width="110" FontWeight="SemiBold"/>

                <DataGridTextColumn Header="Data Pagto" Binding="{Binding DataPagamento, StringFormat=dd/MM/yyyy}" Width="100"/>
            </DataGrid.Columns>
        </DataGrid>

        <Border Grid.Row="2" Margin="0,15,0,15" Padding="15,10" Background="#F9F9F9" BorderBrush="#EEEEEE" BorderThickness="1" CornerRadius="5">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">

                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,30,0">
                    <TextBlock Text="Saldo Previsto (Agendado):" FontSize="14" Foreground="#666666" Margin="0,0,10,0" VerticalAlignment="Center"/>
                    <Border Background="#FFF8E1" CornerRadius="3" Padding="8,2">
                        <TextBlock Text="{Binding SaldoPrevisto, StringFormat=C2}" FontSize="16" FontWeight="Bold" Foreground="#CC8800"/>
                    </Border>
                </StackPanel>

                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="Saldo Realizado (Caixa):" FontSize="14" Foreground="#666666" Margin="0,0,10,0" VerticalAlignment="Center"/>
                    <Border Background="#E3F2FD" CornerRadius="3" Padding="8,2">
                        <TextBlock Text="{Binding SaldoPeriodo, StringFormat=C2}" FontSize="18" FontWeight="Bold" Foreground="#1565C0"/>
                    </Border>
                </StackPanel>

            </StackPanel>
        </Border>

        <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right">

            <Button Content="❌ Cancelar Lançamento" 
                    Command="{Binding CancelarCommand}" 
                    Background="White" BorderBrush="#FFCDD2" BorderThickness="1" Foreground="#C62828"
                    Width="160" Height="40" Margin="0,0,10,0"/>

            <Button Content="↩️ ESTORNAR" 
                    Command="{Binding EstornarCommand}" 
                    Width="120" Height="40" Margin="0,0,10,0" 
                    Background="#FFE0B2" FontWeight="SemiBold"/>

            <Button Content="✏️ EDITAR" 
                    Command="{Binding EditarCommand}" 
                    Width="100" Height="40" Margin="0,0,10,0" 
                    Background="#FFF9C4" FontWeight="SemiBold"/>

            <Button Content="💲 BAIXAR / PAGAR" 
                    Command="{Binding BaixarCommand}" 
                    Width="150" Height="40" Margin="0,0,10,0" 
                    Background="#C8E6C9" FontWeight="Bold" Foreground="#1B5E20"/>

            <Button Content="➕ NOVO LANÇAMENTO" 
                    Command="{Binding NovoCommand}" 
                    Width="180" Height="40" 
                    Background="#2196F3" Foreground="White" FontWeight="Bold" BorderThickness="0"/>
        </StackPanel>

    </Grid>
</Window>